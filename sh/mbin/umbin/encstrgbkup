#!/bin/sh -e
[ "$(id -u)" -ne 0 ] && exit 1
[ "$#" -eq 0 ] && exit 2
. /usr/subr/out
D=/mnt/strg/enc/bkup
[ ! -e $D ] && perrexit "$D: no exist" 3
for d in "$@"; do
	[ -d "$d" ] || perrexit "$d: not a dir" 4
done
for dir in "$@"; do
	tar czf \
		$D/"$(readlink -f "$dir" | sed 's|/|_|g')@$(date +%Y-%m-%d_%T).tar.gz" \
		"$dir" >/dev/null
done
